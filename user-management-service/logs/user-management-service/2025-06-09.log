2025-06-09 16:03:33.335 [] [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2025-06-09 16:03:33.349 [] [main] INFO  UserServiceImpl - Updating current user: testUser
2025-06-09 16:03:33.355 [] [main] DEBUG UserServiceImpl - Updated first name for user: com.ratedistribution.usermanagement.entity.User@3d0f4ac4
2025-06-09 16:03:33.355 [] [main] DEBUG UserServiceImpl - Saved updated user: com.ratedistribution.usermanagement.entity.User@3d0f4ac4
2025-06-09 16:03:33.355 [] [main] TRACE UserServiceImpl - Exiting updateCurrentUser method in UserServiceImpl
2025-06-09 16:03:33.403 [] [main] TRACE UserServiceImpl - Entering getAllUsersFilteredAndSorted method in UserServiceImpl
2025-06-09 16:03:33.403 [] [main] INFO  UserServiceImpl - Fetching users with filters: page=0, size=10, sortBy=username, direction=ASC
2025-06-09 16:03:33.412 [] [main] DEBUG UserServiceImpl - Fetched 1 users
2025-06-09 16:03:33.412 [] [main] TRACE UserServiceImpl - Exiting getAllUsersFilteredAndSorted method in UserServiceImpl
2025-06-09 16:03:33.422 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:03:33.423 [] [main] DEBUG UserServiceImpl - Updating user with id: 1
2025-06-09 16:03:33.424 [] [main] ERROR UserServiceImpl - User doesn't exist with id 1
2025-06-09 16:03:33.435 [] [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2025-06-09 16:03:33.435 [] [main] DEBUG UserServiceImpl - Creating user with username: newUser
2025-06-09 16:03:33.472 [] [main] INFO  UserServiceImpl - Sent create message to RabbitMQ for user: newUser
2025-06-09 16:03:33.473 [] [main] INFO  UserServiceImpl - User created successfully: newUser
2025-06-09 16:03:33.473 [] [main] TRACE UserServiceImpl - Exiting createUser method in UserServiceImpl
2025-06-09 16:03:33.478 [] [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2025-06-09 16:03:33.479 [] [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2025-06-09 16:03:33.479 [] [main] DEBUG UserServiceImpl - Found username: testUser
2025-06-09 16:03:33.479 [] [main] TRACE UserServiceImpl - Exiting getUsernameByEmail method in UserServiceImpl
2025-06-09 16:03:33.484 [] [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2025-06-09 16:03:33.485 [] [main] DEBUG UserServiceImpl - Creating user with username: null
2025-06-09 16:03:33.485 [] [main] ERROR UserServiceImpl - Email 'existingEmail@example.com' is already taken
2025-06-09 16:03:33.495 [] [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2025-06-09 16:03:33.496 [] [main] INFO  UserServiceImpl - Fetching user by ID: 1
2025-06-09 16:03:33.497 [] [main] DEBUG UserServiceImpl - Fetched user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2025-06-09 16:03:33.501 [] [main] TRACE UserServiceImpl - Exiting getUserById method in UserServiceImpl
2025-06-09 16:03:33.506 [] [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2025-06-09 16:03:33.506 [] [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2025-06-09 16:03:33.507 [] [main] DEBUG UserServiceImpl - Fetched current user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2025-06-09 16:03:33.507 [] [main] TRACE UserServiceImpl - Exiting getCurrentUser method in UserServiceImpl
2025-06-09 16:03:33.512 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:03:33.512 [] [main] DEBUG UserServiceImpl - Updating user with id: null
2025-06-09 16:03:33.512 [] [main] ERROR UserServiceImpl - Id must not be null
2025-06-09 16:03:33.516 [] [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2025-06-09 16:03:33.516 [] [main] DEBUG UserServiceImpl - Restoring user with id: 1
2025-06-09 16:03:33.517 [] [main] INFO  UserServiceImpl - Sent restore message to RabbitMQ for user: userToRestore
2025-06-09 16:03:33.517 [] [main] INFO  UserServiceImpl - User restored successfully: userToRestore
2025-06-09 16:03:33.518 [] [main] TRACE UserServiceImpl - Exiting restoreUser method in UserServiceImpl
2025-06-09 16:03:33.523 [] [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2025-06-09 16:03:33.523 [] [main] INFO  UserServiceImpl - Fetching user by ID: 1
2025-06-09 16:03:33.523 [] [main] ERROR UserServiceImpl - User not found with ID: 1
2025-06-09 16:03:33.528 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:03:33.528 [] [main] DEBUG UserServiceImpl - Updating user with id: 1
2025-06-09 16:03:33.529 [] [main] ERROR UserServiceImpl - Email is already taken newEmail@example.com
2025-06-09 16:03:33.534 [] [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2025-06-09 16:03:33.534 [] [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2025-06-09 16:03:33.536 [] [main] INFO  UserServiceImpl - Successfully sent remove role message for user 'existingUser'
2025-06-09 16:03:33.537 [] [main] INFO  UserServiceImpl - Role 'ADMIN' removed successfully from user 'existingUser'
2025-06-09 16:03:33.537 [] [main] TRACE UserServiceImpl - Exiting removeRole method in UserServiceImpl
2025-06-09 16:03:33.542 [] [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2025-06-09 16:03:33.543 [] [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2025-06-09 16:03:33.543 [] [main] ERROR UserServiceImpl - User not found with id '1'
2025-06-09 16:03:33.548 [] [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2025-06-09 16:03:33.549 [] [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2025-06-09 16:03:33.549 [] [main] ERROR UserServiceImpl - User 'existingUser' already has this role: 'ADMIN'
2025-06-09 16:03:33.553 [] [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2025-06-09 16:03:33.554 [] [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2025-06-09 16:03:33.554 [] [main] ERROR UserServiceImpl - Cannot remove role. User 'existingUser' must have at least one role
2025-06-09 16:03:33.558 [] [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2025-06-09 16:03:33.559 [] [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2025-06-09 16:03:33.559 [] [main] ERROR UserServiceImpl - User not found with id: '1'
2025-06-09 16:03:33.562 [] [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2025-06-09 16:03:33.563 [] [main] DEBUG UserServiceImpl - Restoring user with id: 1
2025-06-09 16:03:33.563 [] [main] ERROR UserServiceImpl - User does not exist with id 1
2025-06-09 16:03:33.566 [] [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2025-06-09 16:03:33.567 [] [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2025-06-09 16:03:33.567 [] [main] ERROR UserServiceImpl - No users registered to this email address: test@example.com
2025-06-09 16:03:33.572 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:03:33.572 [] [main] DEBUG UserServiceImpl - Updating user with id: 1
2025-06-09 16:03:33.573 [] [main] ERROR UserServiceImpl - Username is taken newUsername
2025-06-09 16:03:33.577 [] [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2025-06-09 16:03:33.578 [] [main] DEBUG UserServiceImpl - Deleting user with id: 1
2025-06-09 16:03:33.578 [] [main] ERROR UserServiceImpl - User doesn't exist with id: 1
2025-06-09 16:03:33.583 [] [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2025-06-09 16:03:33.583 [] [main] INFO  UserServiceImpl - Adding role 'OPERATOR' to user with id '1'
2025-06-09 16:03:33.584 [] [main] INFO  UserServiceImpl - Successfully sent add role message for user 'existingUser'
2025-06-09 16:03:33.584 [] [main] INFO  UserServiceImpl - Role 'OPERATOR' added successfully to user 'existingUser'
2025-06-09 16:03:33.584 [] [main] TRACE UserServiceImpl - Exiting addRole method in UserServiceImpl
2025-06-09 16:03:33.589 [] [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2025-06-09 16:03:33.590 [] [main] DEBUG UserServiceImpl - Deleting user with id: 1
2025-06-09 16:03:33.590 [] [main] INFO  UserServiceImpl - Sent delete message to RabbitMQ for user: userToDelete
2025-06-09 16:03:33.591 [] [main] INFO  UserServiceImpl - User deleted successfully: userToDelete
2025-06-09 16:03:33.591 [] [main] TRACE UserServiceImpl - Exiting deleteUser method in UserServiceImpl
2025-06-09 16:03:33.595 [] [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2025-06-09 16:03:33.596 [] [main] DEBUG UserServiceImpl - Creating user with username: existingUser
2025-06-09 16:03:33.596 [] [main] ERROR UserServiceImpl - Username 'existingUser' is already taken
2025-06-09 16:03:33.601 [] [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2025-06-09 16:03:33.601 [] [main] INFO  UserServiceImpl - Updating current user: testUser
2025-06-09 16:03:33.602 [] [main] ERROR UserServiceImpl - User doesn't exist with username: testUser
2025-06-09 16:03:33.606 [] [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2025-06-09 16:03:33.606 [] [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2025-06-09 16:03:33.606 [] [main] ERROR UserServiceImpl - User not found with username: testUser
2025-06-09 16:03:33.681 [] [main] TRACE UserController - Entering addRole method in UserController class
2025-06-09 16:03:33.682 [] [main] INFO  UserController - Adding role to user with id: 1
2025-06-09 16:03:33.682 [] [main] INFO  UserController - Role added to user with id 1 successfully
2025-06-09 16:03:33.682 [] [main] TRACE UserController - Exiting addRole method in UserController class
2025-06-09 16:03:33.706 [] [main] TRACE UserController - Entering getUsernameByEmail method in UserController class
2025-06-09 16:03:33.707 [] [main] INFO  UserController - Fetching username by email: test@example.com
2025-06-09 16:03:33.707 [] [main] TRACE UserController - Exiting getUsernameByEmail method in UserController class
2025-06-09 16:03:33.711 [] [main] TRACE UserController - Entering getCurrentUser method in UserController class
2025-06-09 16:03:33.711 [] [main] INFO  UserController - Fetching current user by username: testUser
2025-06-09 16:03:33.712 [] [main] INFO  UserController - Current user retrieved successfully
2025-06-09 16:03:33.712 [] [main] TRACE UserController - Exiting getCurrentUser method in UserController class
2025-06-09 16:03:33.717 [] [main] TRACE UserController - Entering updateUser method in UserController class
2025-06-09 16:03:33.718 [] [main] INFO  UserController - Updating user with details: UpdateUserRequest(id=null, firstName=null, lastName=null, username=null, email=null, gender=null)
2025-06-09 16:03:33.721 [] [main] INFO  UserController - User updated successfully
2025-06-09 16:03:33.721 [] [main] TRACE UserController - Exiting updateUser method in UserController class
2025-06-09 16:03:33.727 [] [main] TRACE UserController - Entering restoreUser method in UserController class
2025-06-09 16:03:33.727 [] [main] INFO  UserController - Restoring user with id: 1
2025-06-09 16:03:33.727 [] [main] INFO  UserController - User with id 1 restored successfully
2025-06-09 16:03:33.727 [] [main] TRACE UserController - Exiting restoreUser method in UserController class
2025-06-09 16:03:33.733 [] [main] TRACE UserController - Entering getAllUsersFilteredAndSorted method in UserController class
2025-06-09 16:03:33.733 [] [main] INFO  UserController - Fetching users with filters - page: 0, size: 3, sortBy: id, direction: ASC, firstName: null, lastName: null, username: null, hospitalId: null, email: null, role: null, gender: null, deleted: null
2025-06-09 16:03:33.734 [] [main] INFO  UserController - Users filtered and sorted fetched successfully
2025-06-09 16:03:33.734 [] [main] TRACE UserController - Exiting getAllUsersFilteredAndSorted method in UserController class
2025-06-09 16:03:33.738 [] [main] TRACE UserController - Entering removeRole method in UserController class
2025-06-09 16:03:33.738 [] [main] INFO  UserController - Removing role from user with id: 1
2025-06-09 16:03:33.739 [] [main] INFO  UserController - Role removed from user with id 1 successfully
2025-06-09 16:03:33.739 [] [main] TRACE UserController - Exiting removeRole method in UserController class
2025-06-09 16:03:33.744 [] [main] TRACE UserController - Entering createUser method in UserController class
2025-06-09 16:03:33.744 [] [main] INFO  UserController - Creating a new user with details: CreateUserRequest(firstName=null, lastName=null, username=null, email=null, password=null, roles=null, gender=null)
2025-06-09 16:03:33.747 [] [main] INFO  UserController - User created successfully
2025-06-09 16:03:33.748 [] [main] TRACE UserController - Exiting createUser method in UserController class
2025-06-09 16:03:33.752 [] [main] TRACE UserController - Entering deleteUser method in UserController class
2025-06-09 16:03:33.753 [] [main] INFO  UserController - Deleting user with id: 1
2025-06-09 16:03:33.753 [] [main] INFO  UserController - User with id 1 deleted successfully
2025-06-09 16:03:33.753 [] [main] TRACE UserController - Exiting deleteUser method in UserController class
2025-06-09 16:03:33.757 [] [main] TRACE UserController - Entering getUserById method in UserController class
2025-06-09 16:03:33.758 [] [main] INFO  UserController - Fetching user by id: 1
2025-06-09 16:03:33.758 [] [main] INFO  UserController - User with id 1 retrieved successfully
2025-06-09 16:03:33.758 [] [main] TRACE UserController - Exiting getUserById method in UserController class
2025-06-09 16:03:33.761 [] [main] TRACE UserController - Entering updateCurrentUser method in UserController class
2025-06-09 16:03:33.761 [] [main] INFO  UserController - Updating current user with username: testUser
2025-06-09 16:03:33.762 [] [main] INFO  UserController - Current user updated successfully
2025-06-09 16:03:33.762 [] [main] TRACE UserController - Exiting updateCurrentUser method in UserController class
2025-06-09 16:11:34.251 [] [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2025-06-09 16:11:34.268 [] [main] INFO  UserServiceImpl - Updating current user: testUser
2025-06-09 16:11:34.271 [] [main] DEBUG UserServiceImpl - Updated first name for user: com.ratedistribution.usermanagement.entity.User@3d0f4ac4
2025-06-09 16:11:34.271 [] [main] DEBUG UserServiceImpl - Saved updated user: com.ratedistribution.usermanagement.entity.User@3d0f4ac4
2025-06-09 16:11:34.271 [] [main] TRACE UserServiceImpl - Exiting updateCurrentUser method in UserServiceImpl
2025-06-09 16:11:34.333 [] [main] TRACE UserServiceImpl - Entering getAllUsersFilteredAndSorted method in UserServiceImpl
2025-06-09 16:11:34.333 [] [main] INFO  UserServiceImpl - Fetching users with filters: page=0, size=10, sortBy=username, direction=ASC
2025-06-09 16:11:34.333 [] [main] DEBUG UserServiceImpl - Fetched 1 users
2025-06-09 16:11:34.333 [] [main] TRACE UserServiceImpl - Exiting getAllUsersFilteredAndSorted method in UserServiceImpl
2025-06-09 16:11:34.349 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:11:34.349 [] [main] DEBUG UserServiceImpl - Updating user with id: 1
2025-06-09 16:11:34.349 [] [main] ERROR UserServiceImpl - User doesn't exist with id 1
2025-06-09 16:11:34.359 [] [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2025-06-09 16:11:34.359 [] [main] DEBUG UserServiceImpl - Creating user with username: newUser
2025-06-09 16:11:34.385 [] [main] INFO  UserServiceImpl - Sent create message to RabbitMQ for user: newUser
2025-06-09 16:11:34.385 [] [main] INFO  UserServiceImpl - User created successfully: newUser
2025-06-09 16:11:34.385 [] [main] TRACE UserServiceImpl - Exiting createUser method in UserServiceImpl
2025-06-09 16:11:34.398 [] [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2025-06-09 16:11:34.398 [] [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2025-06-09 16:11:34.398 [] [main] DEBUG UserServiceImpl - Found username: testUser
2025-06-09 16:11:34.398 [] [main] TRACE UserServiceImpl - Exiting getUsernameByEmail method in UserServiceImpl
2025-06-09 16:11:34.398 [] [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2025-06-09 16:11:34.398 [] [main] DEBUG UserServiceImpl - Creating user with username: null
2025-06-09 16:11:34.398 [] [main] ERROR UserServiceImpl - Email 'existingEmail@example.com' is already taken
2025-06-09 16:11:34.409 [] [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2025-06-09 16:11:34.411 [] [main] INFO  UserServiceImpl - Fetching user by ID: 1
2025-06-09 16:11:34.411 [] [main] DEBUG UserServiceImpl - Fetched user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2025-06-09 16:11:34.412 [] [main] TRACE UserServiceImpl - Exiting getUserById method in UserServiceImpl
2025-06-09 16:11:34.412 [] [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2025-06-09 16:11:34.412 [] [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2025-06-09 16:11:34.412 [] [main] DEBUG UserServiceImpl - Fetched current user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2025-06-09 16:11:34.412 [] [main] TRACE UserServiceImpl - Exiting getCurrentUser method in UserServiceImpl
2025-06-09 16:11:34.412 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:11:34.426 [] [main] DEBUG UserServiceImpl - Updating user with id: null
2025-06-09 16:11:34.426 [] [main] ERROR UserServiceImpl - Id must not be null
2025-06-09 16:11:34.430 [] [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2025-06-09 16:11:34.430 [] [main] DEBUG UserServiceImpl - Restoring user with id: 1
2025-06-09 16:11:34.430 [] [main] INFO  UserServiceImpl - Sent restore message to RabbitMQ for user: userToRestore
2025-06-09 16:11:34.430 [] [main] INFO  UserServiceImpl - User restored successfully: userToRestore
2025-06-09 16:11:34.430 [] [main] TRACE UserServiceImpl - Exiting restoreUser method in UserServiceImpl
2025-06-09 16:11:34.438 [] [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2025-06-09 16:11:34.438 [] [main] INFO  UserServiceImpl - Fetching user by ID: 1
2025-06-09 16:11:34.439 [] [main] ERROR UserServiceImpl - User not found with ID: 1
2025-06-09 16:11:34.446 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:11:34.446 [] [main] DEBUG UserServiceImpl - Updating user with id: 1
2025-06-09 16:11:34.446 [] [main] ERROR UserServiceImpl - Email is already taken newEmail@example.com
2025-06-09 16:11:34.452 [] [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2025-06-09 16:11:34.453 [] [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2025-06-09 16:11:34.455 [] [main] INFO  UserServiceImpl - Successfully sent remove role message for user 'existingUser'
2025-06-09 16:11:34.455 [] [main] INFO  UserServiceImpl - Role 'ADMIN' removed successfully from user 'existingUser'
2025-06-09 16:11:34.455 [] [main] TRACE UserServiceImpl - Exiting removeRole method in UserServiceImpl
2025-06-09 16:11:34.460 [] [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2025-06-09 16:11:34.460 [] [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2025-06-09 16:11:34.460 [] [main] ERROR UserServiceImpl - User not found with id '1'
2025-06-09 16:11:34.460 [] [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2025-06-09 16:11:34.460 [] [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2025-06-09 16:11:34.460 [] [main] ERROR UserServiceImpl - User 'existingUser' already has this role: 'ADMIN'
2025-06-09 16:11:34.460 [] [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2025-06-09 16:11:34.460 [] [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2025-06-09 16:11:34.460 [] [main] ERROR UserServiceImpl - Cannot remove role. User 'existingUser' must have at least one role
2025-06-09 16:11:34.460 [] [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2025-06-09 16:11:34.460 [] [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2025-06-09 16:11:34.474 [] [main] ERROR UserServiceImpl - User not found with id: '1'
2025-06-09 16:11:34.474 [] [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2025-06-09 16:11:34.478 [] [main] DEBUG UserServiceImpl - Restoring user with id: 1
2025-06-09 16:11:34.478 [] [main] ERROR UserServiceImpl - User does not exist with id 1
2025-06-09 16:11:34.478 [] [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2025-06-09 16:11:34.478 [] [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2025-06-09 16:11:34.483 [] [main] ERROR UserServiceImpl - No users registered to this email address: test@example.com
2025-06-09 16:11:34.483 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:11:34.483 [] [main] DEBUG UserServiceImpl - Updating user with id: 1
2025-06-09 16:11:34.483 [] [main] ERROR UserServiceImpl - Username is taken newUsername
2025-06-09 16:11:34.491 [] [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2025-06-09 16:11:34.491 [] [main] DEBUG UserServiceImpl - Deleting user with id: 1
2025-06-09 16:11:34.491 [] [main] ERROR UserServiceImpl - User doesn't exist with id: 1
2025-06-09 16:11:34.495 [] [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2025-06-09 16:11:34.495 [] [main] INFO  UserServiceImpl - Adding role 'OPERATOR' to user with id '1'
2025-06-09 16:11:34.495 [] [main] INFO  UserServiceImpl - Successfully sent add role message for user 'existingUser'
2025-06-09 16:11:34.495 [] [main] INFO  UserServiceImpl - Role 'OPERATOR' added successfully to user 'existingUser'
2025-06-09 16:11:34.495 [] [main] TRACE UserServiceImpl - Exiting addRole method in UserServiceImpl
2025-06-09 16:11:34.495 [] [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2025-06-09 16:11:34.495 [] [main] DEBUG UserServiceImpl - Deleting user with id: 1
2025-06-09 16:11:34.495 [] [main] INFO  UserServiceImpl - Sent delete message to RabbitMQ for user: userToDelete
2025-06-09 16:11:34.495 [] [main] INFO  UserServiceImpl - User deleted successfully: userToDelete
2025-06-09 16:11:34.495 [] [main] TRACE UserServiceImpl - Exiting deleteUser method in UserServiceImpl
2025-06-09 16:11:34.507 [] [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2025-06-09 16:11:34.507 [] [main] DEBUG UserServiceImpl - Creating user with username: existingUser
2025-06-09 16:11:34.507 [] [main] ERROR UserServiceImpl - Username 'existingUser' is already taken
2025-06-09 16:11:34.511 [] [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2025-06-09 16:11:34.514 [] [main] INFO  UserServiceImpl - Updating current user: testUser
2025-06-09 16:11:34.514 [] [main] ERROR UserServiceImpl - User doesn't exist with username: testUser
2025-06-09 16:11:34.519 [] [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2025-06-09 16:11:34.519 [] [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2025-06-09 16:11:34.519 [] [main] ERROR UserServiceImpl - User not found with username: testUser
2025-06-09 16:11:34.598 [] [main] TRACE UserController - Entering addRole method in UserController class
2025-06-09 16:11:34.598 [] [main] INFO  UserController - Adding role to user with id: 1
2025-06-09 16:11:34.598 [] [main] INFO  UserController - Role added to user with id 1 successfully
2025-06-09 16:11:34.598 [] [main] TRACE UserController - Exiting addRole method in UserController class
2025-06-09 16:11:34.614 [] [main] TRACE UserController - Entering getUsernameByEmail method in UserController class
2025-06-09 16:11:34.614 [] [main] INFO  UserController - Fetching username by email: test@example.com
2025-06-09 16:11:34.614 [] [main] TRACE UserController - Exiting getUsernameByEmail method in UserController class
2025-06-09 16:11:34.627 [] [main] TRACE UserController - Entering getCurrentUser method in UserController class
2025-06-09 16:11:34.627 [] [main] INFO  UserController - Fetching current user by username: testUser
2025-06-09 16:11:34.627 [] [main] INFO  UserController - Current user retrieved successfully
2025-06-09 16:11:34.627 [] [main] TRACE UserController - Exiting getCurrentUser method in UserController class
2025-06-09 16:11:34.631 [] [main] TRACE UserController - Entering updateUser method in UserController class
2025-06-09 16:11:34.631 [] [main] INFO  UserController - Updating user with details: UpdateUserRequest(id=null, firstName=null, lastName=null, username=null, email=null, gender=null)
2025-06-09 16:11:34.635 [] [main] INFO  UserController - User updated successfully
2025-06-09 16:11:34.635 [] [main] TRACE UserController - Exiting updateUser method in UserController class
2025-06-09 16:11:34.639 [] [main] TRACE UserController - Entering restoreUser method in UserController class
2025-06-09 16:11:34.639 [] [main] INFO  UserController - Restoring user with id: 1
2025-06-09 16:11:34.639 [] [main] INFO  UserController - User with id 1 restored successfully
2025-06-09 16:11:34.639 [] [main] TRACE UserController - Exiting restoreUser method in UserController class
2025-06-09 16:11:34.645 [] [main] TRACE UserController - Entering getAllUsersFilteredAndSorted method in UserController class
2025-06-09 16:11:34.645 [] [main] INFO  UserController - Fetching users with filters - page: 0, size: 3, sortBy: id, direction: ASC, firstName: null, lastName: null, username: null, hospitalId: null, email: null, role: null, gender: null, deleted: null
2025-06-09 16:11:34.645 [] [main] INFO  UserController - Users filtered and sorted fetched successfully
2025-06-09 16:11:34.645 [] [main] TRACE UserController - Exiting getAllUsersFilteredAndSorted method in UserController class
2025-06-09 16:11:34.647 [] [main] TRACE UserController - Entering removeRole method in UserController class
2025-06-09 16:11:34.647 [] [main] INFO  UserController - Removing role from user with id: 1
2025-06-09 16:11:34.647 [] [main] INFO  UserController - Role removed from user with id 1 successfully
2025-06-09 16:11:34.647 [] [main] TRACE UserController - Exiting removeRole method in UserController class
2025-06-09 16:11:34.654 [] [main] TRACE UserController - Entering createUser method in UserController class
2025-06-09 16:11:34.654 [] [main] INFO  UserController - Creating a new user with details: CreateUserRequest(firstName=null, lastName=null, username=null, email=null, password=null, roles=null, gender=null)
2025-06-09 16:11:34.654 [] [main] INFO  UserController - User created successfully
2025-06-09 16:11:34.654 [] [main] TRACE UserController - Exiting createUser method in UserController class
2025-06-09 16:11:34.661 [] [main] TRACE UserController - Entering deleteUser method in UserController class
2025-06-09 16:11:34.661 [] [main] INFO  UserController - Deleting user with id: 1
2025-06-09 16:11:34.661 [] [main] INFO  UserController - User with id 1 deleted successfully
2025-06-09 16:11:34.661 [] [main] TRACE UserController - Exiting deleteUser method in UserController class
2025-06-09 16:11:34.661 [] [main] TRACE UserController - Entering getUserById method in UserController class
2025-06-09 16:11:34.661 [] [main] INFO  UserController - Fetching user by id: 1
2025-06-09 16:11:34.661 [] [main] INFO  UserController - User with id 1 retrieved successfully
2025-06-09 16:11:34.661 [] [main] TRACE UserController - Exiting getUserById method in UserController class
2025-06-09 16:11:34.669 [] [main] TRACE UserController - Entering updateCurrentUser method in UserController class
2025-06-09 16:11:34.669 [] [main] INFO  UserController - Updating current user with username: testUser
2025-06-09 16:11:34.669 [] [main] INFO  UserController - Current user updated successfully
2025-06-09 16:11:34.669 [] [main] TRACE UserController - Exiting updateCurrentUser method in UserController class
2025-06-09 16:16:28.588 [] [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2025-06-09 16:16:28.591 [] [main] INFO  UserServiceImpl - Updating current user: testUser
2025-06-09 16:16:28.591 [] [main] DEBUG UserServiceImpl - Updated first name for user: com.ratedistribution.usermanagement.entity.User@3d0f4ac4
2025-06-09 16:16:28.606 [] [main] DEBUG UserServiceImpl - Saved updated user: com.ratedistribution.usermanagement.entity.User@3d0f4ac4
2025-06-09 16:16:28.606 [] [main] TRACE UserServiceImpl - Exiting updateCurrentUser method in UserServiceImpl
2025-06-09 16:16:28.638 [] [main] TRACE UserServiceImpl - Entering getAllUsersFilteredAndSorted method in UserServiceImpl
2025-06-09 16:16:28.638 [] [main] INFO  UserServiceImpl - Fetching users with filters: page=0, size=10, sortBy=username, direction=ASC
2025-06-09 16:16:28.659 [] [main] DEBUG UserServiceImpl - Fetched 1 users
2025-06-09 16:16:28.659 [] [main] TRACE UserServiceImpl - Exiting getAllUsersFilteredAndSorted method in UserServiceImpl
2025-06-09 16:16:28.664 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:16:28.664 [] [main] DEBUG UserServiceImpl - Updating user with id: 1
2025-06-09 16:16:28.669 [] [main] ERROR UserServiceImpl - User doesn't exist with id 1
2025-06-09 16:16:28.670 [] [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2025-06-09 16:16:28.670 [] [main] DEBUG UserServiceImpl - Creating user with username: newUser
2025-06-09 16:16:28.685 [] [main] INFO  UserServiceImpl - Sent create message to RabbitMQ for user: newUser
2025-06-09 16:16:28.685 [] [main] INFO  UserServiceImpl - User created successfully: newUser
2025-06-09 16:16:28.685 [] [main] TRACE UserServiceImpl - Exiting createUser method in UserServiceImpl
2025-06-09 16:16:28.685 [] [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2025-06-09 16:16:28.685 [] [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2025-06-09 16:16:28.701 [] [main] DEBUG UserServiceImpl - Found username: testUser
2025-06-09 16:16:28.701 [] [main] TRACE UserServiceImpl - Exiting getUsernameByEmail method in UserServiceImpl
2025-06-09 16:16:28.701 [] [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2025-06-09 16:16:28.701 [] [main] DEBUG UserServiceImpl - Creating user with username: null
2025-06-09 16:16:28.701 [] [main] ERROR UserServiceImpl - Email 'existingEmail@example.com' is already taken
2025-06-09 16:16:28.701 [] [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2025-06-09 16:16:28.701 [] [main] INFO  UserServiceImpl - Fetching user by ID: 1
2025-06-09 16:16:28.701 [] [main] DEBUG UserServiceImpl - Fetched user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2025-06-09 16:16:28.716 [] [main] TRACE UserServiceImpl - Exiting getUserById method in UserServiceImpl
2025-06-09 16:16:28.716 [] [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2025-06-09 16:16:28.716 [] [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2025-06-09 16:16:28.716 [] [main] DEBUG UserServiceImpl - Fetched current user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2025-06-09 16:16:28.716 [] [main] TRACE UserServiceImpl - Exiting getCurrentUser method in UserServiceImpl
2025-06-09 16:16:28.728 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:16:28.728 [] [main] DEBUG UserServiceImpl - Updating user with id: null
2025-06-09 16:16:28.728 [] [main] ERROR UserServiceImpl - Id must not be null
2025-06-09 16:16:28.732 [] [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2025-06-09 16:16:28.732 [] [main] DEBUG UserServiceImpl - Restoring user with id: 1
2025-06-09 16:16:28.732 [] [main] INFO  UserServiceImpl - Sent restore message to RabbitMQ for user: userToRestore
2025-06-09 16:16:28.732 [] [main] INFO  UserServiceImpl - User restored successfully: userToRestore
2025-06-09 16:16:28.732 [] [main] TRACE UserServiceImpl - Exiting restoreUser method in UserServiceImpl
2025-06-09 16:16:28.732 [] [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2025-06-09 16:16:28.732 [] [main] INFO  UserServiceImpl - Fetching user by ID: 1
2025-06-09 16:16:28.732 [] [main] ERROR UserServiceImpl - User not found with ID: 1
2025-06-09 16:16:28.732 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:16:28.732 [] [main] DEBUG UserServiceImpl - Updating user with id: 1
2025-06-09 16:16:28.732 [] [main] ERROR UserServiceImpl - Email is already taken newEmail@example.com
2025-06-09 16:16:28.748 [] [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2025-06-09 16:16:28.748 [] [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2025-06-09 16:16:28.748 [] [main] INFO  UserServiceImpl - Successfully sent remove role message for user 'existingUser'
2025-06-09 16:16:28.748 [] [main] INFO  UserServiceImpl - Role 'ADMIN' removed successfully from user 'existingUser'
2025-06-09 16:16:28.748 [] [main] TRACE UserServiceImpl - Exiting removeRole method in UserServiceImpl
2025-06-09 16:16:28.758 [] [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2025-06-09 16:16:28.758 [] [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2025-06-09 16:16:28.758 [] [main] ERROR UserServiceImpl - User not found with id '1'
2025-06-09 16:16:28.764 [] [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2025-06-09 16:16:28.764 [] [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2025-06-09 16:16:28.764 [] [main] ERROR UserServiceImpl - User 'existingUser' already has this role: 'ADMIN'
2025-06-09 16:16:28.771 [] [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2025-06-09 16:16:28.771 [] [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2025-06-09 16:16:28.771 [] [main] ERROR UserServiceImpl - Cannot remove role. User 'existingUser' must have at least one role
2025-06-09 16:16:28.775 [] [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2025-06-09 16:16:28.775 [] [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2025-06-09 16:16:28.777 [] [main] ERROR UserServiceImpl - User not found with id: '1'
2025-06-09 16:16:28.781 [] [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2025-06-09 16:16:28.781 [] [main] DEBUG UserServiceImpl - Restoring user with id: 1
2025-06-09 16:16:28.781 [] [main] ERROR UserServiceImpl - User does not exist with id 1
2025-06-09 16:16:28.785 [] [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2025-06-09 16:16:28.787 [] [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2025-06-09 16:16:28.787 [] [main] ERROR UserServiceImpl - No users registered to this email address: test@example.com
2025-06-09 16:16:28.790 [] [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2025-06-09 16:16:28.792 [] [main] DEBUG UserServiceImpl - Updating user with id: 1
2025-06-09 16:16:28.792 [] [main] ERROR UserServiceImpl - Username is taken newUsername
2025-06-09 16:16:28.796 [] [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2025-06-09 16:16:28.796 [] [main] DEBUG UserServiceImpl - Deleting user with id: 1
2025-06-09 16:16:28.798 [] [main] ERROR UserServiceImpl - User doesn't exist with id: 1
2025-06-09 16:16:28.798 [] [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2025-06-09 16:16:28.798 [] [main] INFO  UserServiceImpl - Adding role 'OPERATOR' to user with id '1'
2025-06-09 16:16:28.798 [] [main] INFO  UserServiceImpl - Successfully sent add role message for user 'existingUser'
2025-06-09 16:16:28.798 [] [main] INFO  UserServiceImpl - Role 'OPERATOR' added successfully to user 'existingUser'
2025-06-09 16:16:28.798 [] [main] TRACE UserServiceImpl - Exiting addRole method in UserServiceImpl
2025-06-09 16:16:28.798 [] [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2025-06-09 16:16:28.798 [] [main] DEBUG UserServiceImpl - Deleting user with id: 1
2025-06-09 16:16:28.798 [] [main] INFO  UserServiceImpl - Sent delete message to RabbitMQ for user: userToDelete
2025-06-09 16:16:28.798 [] [main] INFO  UserServiceImpl - User deleted successfully: userToDelete
2025-06-09 16:16:28.798 [] [main] TRACE UserServiceImpl - Exiting deleteUser method in UserServiceImpl
2025-06-09 16:16:28.811 [] [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2025-06-09 16:16:28.811 [] [main] DEBUG UserServiceImpl - Creating user with username: existingUser
2025-06-09 16:16:28.811 [] [main] ERROR UserServiceImpl - Username 'existingUser' is already taken
2025-06-09 16:16:28.819 [] [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2025-06-09 16:16:28.819 [] [main] INFO  UserServiceImpl - Updating current user: testUser
2025-06-09 16:16:28.819 [] [main] ERROR UserServiceImpl - User doesn't exist with username: testUser
2025-06-09 16:16:28.827 [] [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2025-06-09 16:16:28.827 [] [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2025-06-09 16:16:28.827 [] [main] ERROR UserServiceImpl - User not found with username: testUser
2025-06-09 16:16:28.894 [] [main] TRACE UserController - Entering addRole method in UserController class
2025-06-09 16:16:28.894 [] [main] INFO  UserController - Adding role to user with id: 1
2025-06-09 16:16:28.894 [] [main] INFO  UserController - Role added to user with id 1 successfully
2025-06-09 16:16:28.894 [] [main] TRACE UserController - Exiting addRole method in UserController class
2025-06-09 16:16:28.905 [] [main] TRACE UserController - Entering getUsernameByEmail method in UserController class
2025-06-09 16:16:28.905 [] [main] INFO  UserController - Fetching username by email: test@example.com
2025-06-09 16:16:28.905 [] [main] TRACE UserController - Exiting getUsernameByEmail method in UserController class
2025-06-09 16:16:28.919 [] [main] TRACE UserController - Entering getCurrentUser method in UserController class
2025-06-09 16:16:28.919 [] [main] INFO  UserController - Fetching current user by username: testUser
2025-06-09 16:16:28.919 [] [main] INFO  UserController - Current user retrieved successfully
2025-06-09 16:16:28.919 [] [main] TRACE UserController - Exiting getCurrentUser method in UserController class
2025-06-09 16:16:28.921 [] [main] TRACE UserController - Entering updateUser method in UserController class
2025-06-09 16:16:28.921 [] [main] INFO  UserController - Updating user with details: UpdateUserRequest(id=null, firstName=null, lastName=null, username=null, email=null, gender=null)
2025-06-09 16:16:28.921 [] [main] INFO  UserController - User updated successfully
2025-06-09 16:16:28.921 [] [main] TRACE UserController - Exiting updateUser method in UserController class
2025-06-09 16:16:28.926 [] [main] TRACE UserController - Entering restoreUser method in UserController class
2025-06-09 16:16:28.926 [] [main] INFO  UserController - Restoring user with id: 1
2025-06-09 16:16:28.926 [] [main] INFO  UserController - User with id 1 restored successfully
2025-06-09 16:16:28.926 [] [main] TRACE UserController - Exiting restoreUser method in UserController class
2025-06-09 16:16:28.926 [] [main] TRACE UserController - Entering getAllUsersFilteredAndSorted method in UserController class
2025-06-09 16:16:28.926 [] [main] INFO  UserController - Fetching users with filters - page: 0, size: 3, sortBy: id, direction: ASC, firstName: null, lastName: null, username: null, hospitalId: null, email: null, role: null, gender: null, deleted: null
2025-06-09 16:16:28.926 [] [main] INFO  UserController - Users filtered and sorted fetched successfully
2025-06-09 16:16:28.926 [] [main] TRACE UserController - Exiting getAllUsersFilteredAndSorted method in UserController class
2025-06-09 16:16:28.937 [] [main] TRACE UserController - Entering removeRole method in UserController class
2025-06-09 16:16:28.937 [] [main] INFO  UserController - Removing role from user with id: 1
2025-06-09 16:16:28.937 [] [main] INFO  UserController - Role removed from user with id 1 successfully
2025-06-09 16:16:28.937 [] [main] TRACE UserController - Exiting removeRole method in UserController class
2025-06-09 16:16:28.941 [] [main] TRACE UserController - Entering createUser method in UserController class
2025-06-09 16:16:28.941 [] [main] INFO  UserController - Creating a new user with details: CreateUserRequest(firstName=null, lastName=null, username=null, email=null, password=null, roles=null, gender=null)
2025-06-09 16:16:28.941 [] [main] INFO  UserController - User created successfully
2025-06-09 16:16:28.941 [] [main] TRACE UserController - Exiting createUser method in UserController class
2025-06-09 16:16:28.941 [] [main] TRACE UserController - Entering deleteUser method in UserController class
2025-06-09 16:16:28.941 [] [main] INFO  UserController - Deleting user with id: 1
2025-06-09 16:16:28.941 [] [main] INFO  UserController - User with id 1 deleted successfully
2025-06-09 16:16:28.941 [] [main] TRACE UserController - Exiting deleteUser method in UserController class
2025-06-09 16:16:28.941 [] [main] TRACE UserController - Entering getUserById method in UserController class
2025-06-09 16:16:28.952 [] [main] INFO  UserController - Fetching user by id: 1
2025-06-09 16:16:28.952 [] [main] INFO  UserController - User with id 1 retrieved successfully
2025-06-09 16:16:28.952 [] [main] TRACE UserController - Exiting getUserById method in UserController class
2025-06-09 16:16:28.952 [] [main] TRACE UserController - Entering updateCurrentUser method in UserController class
2025-06-09 16:16:28.952 [] [main] INFO  UserController - Updating current user with username: testUser
2025-06-09 16:16:28.952 [] [main] INFO  UserController - Current user updated successfully
2025-06-09 16:16:28.952 [] [main] TRACE UserController - Exiting updateCurrentUser method in UserController class
